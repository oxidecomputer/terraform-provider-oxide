---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "oxide_instance Resource - terraform-provider-oxide"
subcategory: ""
description: |-
  This resource manages instances.
  !> Updates will stop and start the instance.
  -> When setting a boot disk using boot_disk_id, the boot disk ID must also be present in disk_attachments.
---

# oxide_instance (Resource)

This resource manages instances.

!> Updates will stop and start the instance.

-> When setting a boot disk using `boot_disk_id`, the boot disk ID must also be present in `disk_attachments`.

## Example Usage

### Instance minimal example

```terraform
resource "oxide_instance" "example" {
  project_id       = "c1dee930-a8e4-11ed-afa1-0242ac120002"
  description      = "Example instance."
  name             = "myinstance"
  hostname         = "myhostname"
  memory           = 10737418240
  ncpus            = 1
  disk_attachments = ["611bb17d-6883-45be-b3aa-8a186fdeafe8"]
}
```

### Instance with user data and an SSH public key and anti-affinity group

```terraform
resource "oxide_instance" "example" {
  project_id           = "c1dee930-a8e4-11ed-afa1-0242ac120002"
  description          = "Example instance."
  name                 = "myinstance"
  hostname             = "myhostname"
  memory               = 10737418240
  ncpus                = 1
  anti_affinity_groups = ["9b9f9be1-96bf-44ad-864a-0dedae3b3999"]
  disk_attachments     = ["611bb17d-6883-45be-b3aa-8a186fdeafe8"]
  ssh_public_keys      = ["066cab1b-c550-4aea-8a80-8422fd3bfc40"]
  user_data            = filebase64("path/to/init.sh")
}
```

### Instance with a custom network interface with resource timeouts

```terraform
resource "oxide_instance" "example" {
  project_id       = "c1dee930-a8e4-11ed-afa1-0242ac120002"
  description      = "Example instance."
  name             = "myinstance"
  hostname         = "myhostname"
  memory           = 10737418240
  ncpus            = 1
  disk_attachments = ["611bb17d-6883-45be-b3aa-8a186fdeafe8"]

  network_interfaces = [
    {
      subnet_id   = "066cab1b-c550-4aea-8a80-8422fd3bfc40"
      vpc_id      = "9b9f9be1-96bf-44ad-864a-0dedae3b3999"
      description = "Example network interface."
      name        = "mynic"

      ip_config = {
        v4 = {
          ip = "172.30.0.6"
        }

        v6 = {
          ip = "auto"
        }
      }
    },
  ]

  timeouts = {
    read   = "1m"
    create = "3m"
    delete = "2m"
  }
}
```

### Instance with external IPs that does not start when created

```terraform
resource "oxide_instance" "example" {
  project_id       = "c1dee930-a8e4-11ed-afa1-0242ac120002"
  description      = "Example instance."
  name             = "myinstance"
  hostname         = "myhostname"
  memory           = 10737418240
  ncpus            = 1
  disk_attachments = ["611bb17d-6883-45be-b3aa-8a186fdeafe8"]
  start_on_create  = false

  external_ips = {
    ephemeral = [
      {
        ip_version = "v4"
      },
      {
        pool_id = "f6f65759-2510-45f5-a3b8-e5090ac56993"
      },
    ]

    floating = [
      {
        id = "43b30584-1580-446d-a213-cad9e298df44",
      }
    ]
  }

  network_interfaces = [
    {
      subnet_id   = "066cab1b-c550-4aea-8a80-8422fd3bfc40"
      vpc_id      = "9b9f9be1-96bf-44ad-864a-0dedae3b3999"
      description = "Example network interface."
      name        = "mynic"

      ip_config = {
        v4 = {
          ip = "auto"
        }
      }
    },
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `description` (String) Description for the instance.
- `memory` (Number) Instance memory in bytes.
- `name` (String) Name of the instance.
- `ncpus` (Number) Number of CPUs allocated for this instance.
- `project_id` (String) ID of the project that will contain the instance.

### Optional

- `anti_affinity_groups` (Set of String) IDs of the anti-affinity groups this instance should belong to.
- `auto_restart_policy` (String) The auto-restart policy for this instance.
- `boot_disk_id` (String) ID of the disk the instance should be booted from. When provided, this ID must also be present in `disk_attachments`.
- `disk_attachments` (Set of String) IDs of the disks to be attached to the instance. When multiple disk IDs are provided, set `boot_disk_id` to specify the boot disk for the instance. Otherwise, a boot disk will be chosen randomly.
- `external_ips` (Attributes) External IP addresses provided to this instance. (see [below for nested schema](#nestedatt--external_ips))
- `hostname` (String) Hostname of the instance.
- `network_interfaces` (Attributes Set) Network interface devices attached to the instance. (see [below for nested schema](#nestedatt--network_interfaces))
- `ssh_public_keys` (Set of String) An allowlist of IDs of the SSH public keys to be transferred to the instance via cloud-init during instance creation.
- `start_on_create` (Boolean) Whether to start the instance on creation.
- `timeouts` (Attributes) (see [below for nested schema](#nestedatt--timeouts))
- `user_data` (String) User data for instance initialization systems (such as cloud-init).
Must be a Base64-encoded string, as specified in [RFC 4648 ยง 4](https://datatracker.ietf.org/doc/html/rfc4648#section-4).
Maximum 32 KiB unencoded data.

### Read-Only

- `attached_network_interfaces` (Attributes Map) Network interfaces attached to the instance. (see [below for nested schema](#nestedatt--attached_network_interfaces))
- `id` (String) Unique, immutable, system-controlled identifier of the instance.
- `time_created` (String) Timestamp of when this instance was created.
- `time_modified` (String) Timestamp of when this instance was last modified.

<a id="nestedatt--external_ips"></a>
### Nested Schema for `external_ips`

Optional:

- `ephemeral` (Attributes Set) External ephemeral IPs to attach to the instance. Each instance can have at most one IPv4 and one IPv6 ephemeral IP. (see [below for nested schema](#nestedatt--external_ips--ephemeral))
- `floating` (Attributes Set) External floating IPs to attach to the instance. (see [below for nested schema](#nestedatt--external_ips--floating))

<a id="nestedatt--external_ips--ephemeral"></a>
### Nested Schema for `external_ips.ephemeral`

Optional:

- `ip_version` (String) IP version to use when multiple default pools exist. Conflicts with `pool_id`.
- `pool_id` (String) ID of the IP pool to allocate from. Conflicts with `ip_version`.


<a id="nestedatt--external_ips--floating"></a>
### Nested Schema for `external_ips.floating`

Required:

- `id` (String) The external floating IP ID.



<a id="nestedatt--network_interfaces"></a>
### Nested Schema for `network_interfaces`

Required:

- `description` (String) Description for the instance network interface.
- `ip_config` (Attributes) IP stack to create for the instance network interface. (see [below for nested schema](#nestedatt--network_interfaces--ip_config))
- `name` (String) Name of the instance network interface.
- `subnet_id` (String) ID of the VPC subnet in which to create the instance network interface.
- `vpc_id` (String) ID of the VPC in which to create the instance network interface.

<a id="nestedatt--network_interfaces--ip_config"></a>
### Nested Schema for `network_interfaces.ip_config`

Optional:

- `v4` (Attributes) Creates an IPv4 stack for the instance network interface. (see [below for nested schema](#nestedatt--network_interfaces--ip_config--v4))
- `v6` (Attributes) (see [below for nested schema](#nestedatt--network_interfaces--ip_config--v6))

<a id="nestedatt--network_interfaces--ip_config--v4"></a>
### Nested Schema for `network_interfaces.ip_config.v4`

Required:

- `ip` (String) The IPv4 address for the instance network interface or "auto" to auto-assign one.


<a id="nestedatt--network_interfaces--ip_config--v6"></a>
### Nested Schema for `network_interfaces.ip_config.v6`

Required:

- `ip` (String) The IPv6 address for the instance network interface or "auto" to auto-assign one.




<a id="nestedatt--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours).
- `delete` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours). Setting a timeout for a Delete operation is only applicable if changes are saved into state before the destroy operation occurs.
- `read` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours). Read operations occur during any refresh or planning operation when refresh is enabled.
- `update` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours).


<a id="nestedatt--attached_network_interfaces"></a>
### Nested Schema for `attached_network_interfaces`

Read-Only:

- `description` (String) Description of the instance network interface.
- `id` (String) Unique, immutable, system-controlled identifier of the instance network interface.
- `instance_id` (String) Instance ID of the network interface.
- `ip_stack` (Attributes) IP stack of the instance network interface. (see [below for nested schema](#nestedatt--attached_network_interfaces--ip_stack))
- `mac_address` (String) MAC address of the instance network interface.
- `name` (String) Name of the instance network interface.
- `primary` (Boolean) True if this is the primary network interface for the instance to which it's attached to.
- `subnet_id` (String) VPC subnet ID of the instance network interface.
- `time_created` (String) Timestamp of when this instance network interface was created.
- `time_modified` (String) Timestamp of when this instance network interface was last modified.
- `vpc_id` (String) VPC ID of the instance network interface.

<a id="nestedatt--attached_network_interfaces--ip_stack"></a>
### Nested Schema for `attached_network_interfaces.ip_stack`

Read-Only:

- `v4` (Attributes) IPv4 stack of the instance network interface. (see [below for nested schema](#nestedatt--attached_network_interfaces--ip_stack--v4))
- `v6` (Attributes) IPv6 stack of the instance network interface. (see [below for nested schema](#nestedatt--attached_network_interfaces--ip_stack--v6))

<a id="nestedatt--attached_network_interfaces--ip_stack--v4"></a>
### Nested Schema for `attached_network_interfaces.ip_stack.v4`

Read-Only:

- `ip` (String) IPv4 address of the instance network interface.


<a id="nestedatt--attached_network_interfaces--ip_stack--v6"></a>
### Nested Schema for `attached_network_interfaces.ip_stack.v6`

Read-Only:

- `ip` (String) IPv6 address of the instance network interface.

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
terraform import oxide_instance.example 3e2c6e84-bed8-4c94-afc3-1032082d6a90
```
